import pandas as pd
import numpy as np
import talib as ta

pd.set_option('display.max_rows', 300)

data = [['1688457600000', '1949.08', '1962.38', '1946.62', '1960.71', '159082.38', '311015271.5695'], ['1688472000000', '1960.71', '1961.7', '1950.57', '1954.48', '112055.58', '219299995.8722'], ['1688486400000', '1954.48', '1966.04', '1931.17', '1933.93', '172104.98', '335395122.342'], ['1688500800000', '1933.93', '1941.43', '1931.48', '1935.14', '138831.26', '269144452.6981'], ['1688515200000', '1935.14', '1941.51', '1932.48', '1940.32', '115121.1', '223203565.5105'], ['1688529600000', '1940.32', '1940.83', '1931.56', '1935.51', '122439.73', '236986027.4809'], ['1688544000000', '1935.51', '1936.32', '1903.07', '1909.27', '212968.02', '408654643.1298'], ['1688558400000', '1909.27', '1912.96', '1893.06', '1901.45', '201258.85', '383071679.9397'], ['1688572800000', '1901.45', '1916.84', '1899.88', '1906.39', '147955.3', '282452987.5034'], ['1688587200000', '1906.39', '1914.81', '1902.72', '1909.23', '123300.12', '235414979.7039'], ['1688601600000', '1909.23', '1914.71', '1896.98', '1912.5', '125832.48', '240133941.7856'], ['1688616000000', '1912.5', '1928.88', '1908.29', '1923.79', '144922.22', '278080188.551'], ['1688630400000', '1923.79', '1957.69', '1910.08', '1916.56', '260881.28', '505761560.3421'], ['1688644800000', '1916.56', '1917.43', '1863.44', '1887.02', '311266.88', '588720185.668'], ['1688659200000', '1887.02', '1893.13', '1877.43', '1884.1', '143304.31', '270138958.3135'], ['1688673600000', '1884.1', '1886.5', '1844.24', '1844.35', '186504.84', '348385644.5545'], ['1688688000000', '1844.35', '1858.24', '1823.77', '1856.44', '174867.22', '322487861.4892'], ['1688702400000', '1856.44', '1862.15', '1850.31', '1854.82', '135224.76', '250814078.6926'], ['1688716800000', '1854.82', '1864.32', '1852.21', '1858.82', '156721.67', '291406839.0748'], ['1688731200000', '1858.82', '1876.95', '1849.77', '1870.76', '233865.55', '436294609.493'], ['1688745600000', '1870.76', '1873.95', '1854.84', '1863.01', '157655.59', '294103941.051'], ['1688760000000', '1863.01', '1870.49', '1861.83', '1869.43', '127680.46', '238258194.7745'], ['1688774400000', '1869.43', '1872.49', '1861.24', '1862.8', '132779.18', '247923099.8728'], ['1688788800000', '1862.8', '1862.8', '1853.93', '1860.13', '127836.84', '237586417.4992'], ['1688803200000', '1860.13', '1866.3', '1855.77', '1857.51', '127548.89', '237451300.9097'], ['1688817600000', '1857.51', '1860.7', '1854.37', '1857.92', '121854.36', '226375463.2549'], ['1688832000000', '1857.92', '1864.8', '1842.22', '1845.36', '160213.73', '297399360.4124'], ['1688846400000', '1845.36', '1865.26', '1840.79', '1863.87', '126523.29', '234349262.7045'], ['1688860800000', '1863.87', '1873.41', '1861.67', '1866.79', '123574.76', '230704458.4531'], ['1688875200000', '1866.79', '1869.49', '1862.5', '1865.91', '111873.92', '208810683.2653'], ['1688889600000', '1865.91', '1868.42', '1863.17', '1867.54', '111159.8', '207461927.86'], ['1688904000000', '1867.54', '1878.3', '1854.91', '1864.96', '152404.46', '284584345.5564'], ['1688918400000', '1864.96', '1867.44', '1860.72', '1867.23', '126995.8', '236735555.4344'], ['1688932800000', '1867.23', '1870.41', '1854.85', '1861.39', '122616.39', '228612432.9179'], ['1688947200000', '1861.39', '1866.61', '1844.97', '1860.42', '144897.67', '269000944.0375'], ['1688961600000', '1860.42', '1861.89', '1851', '1854.85', '112249.95', '208320199.6363'], ['1688976000000', '1854.85', '1864', '1847.5', '1862.72', '126384.92', '234936804.1462'], ['1688990400000', '1862.72', '1872.48', '1858.76', '1869.72', '142817.41', '266385723.4707'], ['1689004800000', '1869.72', '1899.83', '1864.07', '1898.56', '167303.1', '314390918.491'], ['1689019200000', '1898.56', '1904.09', '1865.54', '1878.78', '190333.43', '358432540.4222'], ['1689033600000', '1878.78', '1883.42', '1874', '1878.36', '132771.98', '249418668.9303'], ['1689048000000', '1878.36', '1891.12', '1875.55', '1881.83', '136016.32', '255791058.0428'], ['1689062400000', '1881.83', '1882.63', '1862.46', '1866', '161685.48', '302408485.3878'], ['1689076800000', '1866', '1881.31', '1860.78', '1870.52', '168297.27', '314659710.6417'], ['1689091200000', '1870.52', '1875.18', '1864.5', '1873.42', '157465.55', '294518728.8444'], ['1689105600000', '1873.42', '1878.93', '1870.28', '1877.08', '130924.51', '245419283.7636'], ['1689120000000', '1877.08', '1888', '1875.43', '1879', '153177.11', '288085173.7168'], ['1689134400000', '1879', '1894.89', '1877.2', '1889.38', '104048.6', '196206685.1498'], ['1689148800000', '1889.38', '1890.66', '1885.12', '1889.4', '130651.12', '246566150.1095'], ['1689163200000', '1889.4', '1900.61', '1876.44', '1882.34', '228050.54', '431048541.6731'], ['1689177600000', '1882.34', '1890.82', '1865.23', '1868.73', '154189.1', '290043726.6938'], ['1689192000000', '1868.73', '1872.7', '1862.58', '1870.25', '138843.39', '259501769.9966'], ['1689206400000', '1870.25', '1875', '1864.34', '1866.23', '109399.61', '204498350.1857'], ['1689220800000', '1866.23', '1873.25', '1861.61', '1869.13', '118449.75', '221177051.5817'], ['1689235200000', '1869.13', '1884.15', '1868.43', '1882.41', '161561.38', '303419140.8395'], ['1689249600000', '1882.41', '1944.13', '1874.67', '1932.58', '278885.57', '530196116.8596'], ['1689264000000', '1932.58', '2015.11', '1930.85', '1996.14', '437603.03', '863738250.7323'], ['1689278400000', '1996.14', '2011', '1972.97', '2005.38', '162197.56', '322733560.8017'], ['1689292800000', '2005.38', '2030.61', '2002.98', '2010.21', '168867.04', '340103565.1893'], ['1689307200000', '2010.21', '2013.03', '1987.73', '1991.96', '111433.55', '223475658.2268'], ['1689321600000', '1991.96', '2004.48', '1985.41', '1993.11', '138874.4', '277146978.4354'], ['1689336000000', '1993.11', '2007.78', '1985.08', '1998.65', '134128.22', '267652195.8042'], ['1689350400000', '1998.65', '2001.33', '1896.44', '1911.2', '352949.56', '686921742.8161'], ['1689364800000', '1911.2', '1936.59', '1898.53', '1936.02', '182074.89', '349714311.1223'], ['1689379200000', '1936.02', '1936.15', '1925.1', '1928.97', '140994.15', '272124100.3473'], ['1689393600000', '1928.97', '1941.82', '1925.6', '1940.18', '151274.36', '292156762.8704'], ['1689408000000', '1940.18', '1945.35', '1935.12', '1938.64', '151669.74', '294161385.4893'], ['1689422400000', '1938.64', '1939.98', '1927.33', '1933.28', '146065.94', '282595526.1469'], ['1689436800000', '1933.28', '1937.81', '1928', '1932.22', '144712.74', '279604944.8406'], ['1689451200000', '1932.22', '1932.22', '1925.16', '1929.81', '137321.59', '264812376.9457'], ['1689465600000', '1929.81', '1936.43', '1912.47', '1921.75', '153863.24', '296577512.057'], ['1689480000000', '1921.75', '1930.44', '1919.41', '1923.92', '112924.69', '217357576.3126'], ['1689494400000', '1923.92', '1935.4', '1923.92', '1931.67', '115872.27', '223441848.6273'], ['1689508800000', '1931.67', '1942.2', '1927.54', '1935.59', '110192.78', '213063580.6595'], ['1689523200000', '1935.59', '1938.04', '1924.44', '1926.48', '112842.85', '218083523.5459'], ['1689537600000', '1926.48', '1936.05', '1915.12', '1920.57', '172096.03', '331751858.8557'], ['1689552000000', '1920.57', '1931.02', '1915.64', '1929.84', '190562.53', '366527170.0425'], ['1689566400000', '1929.84', '1934.61', '1925.12', '1927.42', '107682.18', '207848725.7243'], ['1689580800000', '1927.42', '1930', '1890.03', '1908.43', '204981.86', '392092035.613'], ['1689595200000', '1908.43', '1916.24', '1898.66', '1907.05', '170688.66', '325795497.4597'], ['1689609600000', '1907.05', '1911.87', '1871.43', '1886.29', '211291.41', '399815586.0583'], ['1689624000000', '1886.29', '1919.24', '1884.34', '1909.78', '155124.16', '295523147.5082'], ['1689638400000', '1909.78', '1915.91', '1904.75', '1907.56', '161341.98', '308282548.1559'], ['1689652800000', '1907.56', '1910.47', '1891.94', '1897.36', '150006.44', '285449223.6049'], ['1689667200000', '1897.36', '1908.66', '1889.38', '1893.05', '144970.53', '275346578.2181'], ['1689681600000', '1893.05', '1902.86', '1883.62', '1896.09', '148521.37', '281095696.1211'], ['1689696000000', '1896.09', '1902.39', '1874.79', '1890.31', '164202.12', '310591191.3953'], ['1689710400000', '1890.31', '1901.08', '1888.12', '1896.01', '136185.85', '258142251.7355'], ['1689724800000', '1896.01', '1914.27', '1893.94', '1911.32', '146412.95', '279248104.5374'], ['1689739200000', '1911.32', '1917.02', '1906', '1907.47', '143598.53', '274422258.9617'], ['1689753600000', '1907.47', '1910.82', '1900.95', '1908.08', '128568.63', '245182379.6294'], ['1689768000000', '1908.08', '1921.48', '1893.25', '1904.9', '214069.19', '407684582.4794'], ['1689782400000', '1904.9', '1916.96', '1899.51', '1908.69', '147970.92', '282074458.6834'], ['1689796800000', '1908.69', '1908.95', '1880.43', '1886.98', '134316.72', '254079286.2987'], ['1689811200000', '1886.98', '1898.72', '1881.25', '1892.83', '117887.79', '223151283.7711'], ['1689825600000', '1892.83', '1913.12', '1892', '1911.1', '167528.16', '318748006.9258'], ['1689840000000', '1911.1', '1928', '1910.07', '1920.19', '144539.37', '277260955.7185'], ['1689854400000', '1920.19', '1921.98', '1882.2', '1886.77', '240169.69', '456915364.0336'], ['1689868800000', '1886.77', '1892.43', '1876.2', '1886.44', '195630.14', '368805907.0135'], ['1689883200000', '1886.44', '1897.57', '1880.85', '1890.16', '142836.37', '269911364.8799'], ['1689897600000', '1890.16', '1900.47', '1885.29', '1895.32', '140075.27', '265254123.2236'], ['1689912000000', '1895.32', '1896.04', '1885.85', '1887.71', '126230.66', '238739485.1651'], ['1689926400000', '1887.71', '1893.03', '1883.1', '1888.03', '143108.68', '270179162.4525'], ['1689940800000', '1888.03', '1895.31', '1884.61', '1889.75', '159955.44', '302397488.6486'], ['1689955200000', '1889.75', '1904.81', '1883.66', '1893.42', '173576.61', '328837456.5339'], ['1689969600000', '1893.42', '1894.84', '1889.09', '1890.27', '120178.45', '227382768.3629'], ['1689984000000', '1890.27', '1895.87', '1889.71', '1891.57', '119355.77', '225866980.0166'], ['1689998400000', '1891.57', '1894.59', '1888.82', '1890.2', '98070.21', '185476438.1239'], ['1690012800000', '1890.2', '1893', '1882.64', '1886.58', '130063.8', '245482497.8637'], ['1690027200000', '1886.58', '1888.69', '1883.36', '1887.48', '116219.12', '219190020.7936'], ['1690041600000', '1887.48', '1889.42', '1880.64', '1885.78', '116566.99', '219720064.5724'], ['1690056000000', '1885.78', '1887.4', '1845.08', '1865', '139324.8', '260685442.2288'], ['1690070400000', '1865', '1871.94', '1856.54', '1867.83', '115300.93', '215225930.4161'], ['1690084800000', '1867.83', '1878.04', '1867.83', '1873.5', '116818.93', '218733302.8014'], ['1690099200000', '1873.5', '1876.92', '1872.11', '1873.31', '91457.44', '171403729.6129'], ['1690113600000', '1873.31', '1874.73', '1870.45', '1872.67', '78543.65', '147083567.8129'], ['1690128000000', '1872.67', '1904', '1872.67', '1887.78', '216537.09', '409051825.9804'], ['1690142400000', '1887.78', '1892.37', '1873.86', '1887.28', '111190.65', '209578873.3277'], ['1690156800000', '1887.28', '1889.49', '1864.55', '1866.8', '185932.05', '348697878.4453'], ['1690171200000', '1866.8', '1876.31', '1861', '1873.61', '134572.85', '251495256.8762'], ['1690185600000', '1873.61', '1873.82', '1829.45', '1851.62', '198673.17', '368022442.7368'], ['1690200000000', '1851.62', '1853.34', '1832.9', '1841.85', '172680.55', '318714798.5018'], ['1690214400000', '1841.85', '1850', '1837.56', '1848.02', '137245.63', '253170816.7111'], ['1690228800000', '1848.02', '1850.5', '1843.95', '1848.48', '134353', '248214293.1591'], ['1690243200000', '1848.48', '1855.4', '1844.06', '1849.67', '120181.1', '222232312.0694'], ['1690257600000', '1849.67', '1852.44', '1845.07', '1849.32', '150870.08', '279114431.8519'], ['1690272000000', '1849.32', '1862.22', '1848.03', '1852.07', '124457.66', '230722710.5257'], ['1690286400000', '1852.07', '1867.79', '1851.03', '1856.3', '147388.21', '273723107.0972'], ['1690300800000', '1856.3', '1865', '1851.28', '1855.8', '113187.91', '210295076.1925'], ['1690315200000', '1855.8', '1863.63', '1855.07', '1856.34', '94544.97', '175770894.8519'], ['1690329600000', '1856.34', '1865.93', '1850.47', '1857.23', '116257.25', '215803404.4235'], ['1690344000000', '1857.23', '1859.79', '1851', '1851.99', '101638.43', '188498176.7841'], ['1690358400000', '1851.99', '1854.66', '1846.99', '1849.79', '114469.83', '211908428.4193'], ['1690372800000', '1849.79', '1860.17', '1848.9', '1859.42', '123668.48', '229521952.0224'], ['1690387200000', '1859.42', '1882.2', '1853.84', '1872.12', '256094.56', '477495274.8451'], ['1690401600000', '1872.12', '1886.8', '1865.02', '1870.44', '186938.28', '350373923.7888'], ['1690416000000', '1870.44', '1877.74', '1865.83', '1874.68', '135855.1', '254297618.1568'], ['1690430400000', '1874.68', '1880.69', '1863.82', '1870.53', '148109.41', '277827959.4988'], ['1690444800000', '1870.53', '1885', '1868.43', '1875.45', '155124.8', '291217058.0471'], ['1690459200000', '1875.45', '1877.14', '1862.54', '1867.44', '154608.69', '289301405.4976'], ['1690473600000', '1867.44', '1867.85', '1853.72', '1859.38', '153018.76', '284903173.2321'], ['1690488000000', '1859.38', '1860.9', '1853.58', '1859.86', '112414.23', '208889930.0515'], ['1690502400000', '1859.86', '1863.78', '1858.56', '1861.33', '126901.64', '236160051.5079'], ['1690516800000', '1861.33', '1863.46', '1855.22', '1858.19', '102775.58', '191176976.9283'], ['1690531200000', '1858.19', '1867.7', '1857.6', '1865.52', '105958.25', '197500671.1603'], ['1690545600000', '1865.52', '1882.26', '1865.35', '1874.19', '156995.5', '294112859.6403'], ['1690560000000', '1874.19', '1878.9', '1864.76', '1873.02', '128777.83', '241169094.7811'], ['1690574400000', '1873.02', '1877', '1871.23', '1872.94', '103973.23', '194911082.0969'], ['1690588800000', '1872.94', '1876.08', '1871.55', '1872.36', '129579.91', '242778770.5091'], ['1690603200000', '1872.36', '1876.02', '1870.11', '1870.74', '118183.38', '221379635.1881'], ['1690617600000', '1870.74', '1872.44', '1868.42', '1869.2', '111660.55', '208825403.3286'], ['1690632000000', '1869.2', '1874.7', '1868.99', '1871.32', '124467.36', '232993898.437'], ['1690646400000', '1871.32', '1878.3', '1869.9', '1876.88', '112266.21', '210374208.872'], ['1690660800000', '1876.88', '1885.49', '1876.88', '1880.4', '121312.96', '228253425.7327'], ['1690675200000', '1880.4', '1881.44', '1877', '1877.96', '95904.22', '180167377.2948'], ['1690689600000', '1877.96', '1879.43', '1873.48', '1875.03', '122661.62', '230144344.343'], ['1690704000000', '1875.03', '1875.69', '1871.33', '1874.61', '108554.43', '203417953.1166'], ['1690718400000', '1874.61', '1884.33', '1869.82', '1875.27', '122836.37', '230494327.8788'], ['1690732800000', '1875.27', '1878.19', '1856.19', '1860.69', '140538.59', '263121633.187'], ['1690747200000', '1860.69', '1864.44', '1847', '1860.19', '183232.83', '340286333.5347'], ['1690761600000', '1860.19', '1876', '1859.45', '1867.79', '163084.61', '304684995.8431'], ['1690776000000', '1867.79', '1868.57', '1861.09', '1863.8', '123627.06', '230482444.6585'], ['1690790400000', '1863.8', '1868.64', '1863.16', '1866.49', '117916.66', '220069412.255'], ['1690804800000', '1866.49', '1872.12', '1855.2', '1855.79', '142226.87', '265087006.7431'], ['1690819200000', '1855.79', '1861.76', '1852.82', '1855.29', '162569.17', '302096274.5823'], ['1690833600000', '1855.29', '1859.48', '1849.65', '1854.84', '118207.8', '219239787.3471'], ['1690848000000', '1854.84', '1863.42', '1807.84', '1825.3', '216508.5', '397308493.805'], ['1690862400000', '1825.3', '1834.57', '1819.85', '1832.64', '143744.22', '262708790.7726'], ['1690876800000', '1832.64', '1836.24', '1828.94', '1829.45', '132237.02', '242321520.5256'], ['1690891200000', '1829.45', '1835.36', '1812', '1833.69', '156424.1', '286139036.2762'], ['1690905600000', '1833.69', '1856.57', '1828.45', '1849.94', '217460.17', '400462113.4289'], ['1690920000000', '1849.94', '1874.91', '1845.66', '1872.48', '196342.99', '364278251.6157'], ['1690934400000', '1872.48', '1878.71', '1861.9', '1862.15', '169680.49', '317235050.3376'], ['1690948800000', '1862.15', '1863.89', '1854.93', '1855.94', '98607.69', '183434852.8197'], ['1690963200000', '1855.94', '1859.82', '1852.55', '1858.65', '108264.39', '200974394.331'], ['1690977600000', '1858.65', '1859.77', '1833.01', '1841.41', '169637.59', '313376309.4529'], ['1690992000000', '1841.41', '1846.44', '1820', '1840.82', '218399.14', '400498839.5524'], ['1691006400000', '1840.82', '1844.45', '1836.77', '1838.86', '119634.72', '220300287.1797'], ['1691020800000', '1838.86', '1845.2', '1836.21', '1839.6', '114373.1', '210445594.756'], ['1691035200000', '1839.6', '1839.92', '1830.45', '1831.34', '150561.94', '276408017.6894'], ['1691049600000', '1831.34', '1837.88', '1824.92', '1836.67', '149170.88', '273502645.0091'], ['1691064000000', '1836.67', '1849', '1832.61', '1839.6', '182178.07', '335024337.9026'], ['1691078400000', '1839.6', '1858.5', '1838.21', '1845.11', '165459.65', '305616204.8946'], ['1691092800000', '1845.11', '1853.44', '1830.18', '1834.59', '121192.73', '222950144.2293'], ['1691107200000', '1834.59', '1837.96', '1826.94', '1832.94', '119259.88', '218708904.7356'], ['1691121600000', '1832.94', '1836.83', '1829.83', '1836.31', '127078.19', '232974342.6025'], ['1691136000000', '1836.31', '1839.5', '1832.1', '1833.46', '96556.22', '177230242.4723'], ['1691150400000', '1833.46', '1850.3', '1830.03', '1846.2', '225090.1', '414528095.2848'], ['1691164800000', '1846.2', '1847.53', '1825.59', '1829.95', '180073.79', '330814103.1427'], ['1691179200000', '1829.95', '1832.79', '1813.56', '1828.9', '146247.15', '267049377.0035'], ['1691193600000', '1828.9', '1832.26', '1826.35', '1831.01', '100340.2', '183586466.0618'], ['1691208000000', '1831.01', '1832.89', '1827.5', '1829.74', '99764.5', '182575883.6319'], ['1691222400000', '1829.74', '1834.14', '1829.06', '1831.51', '105923.85', '193962933.794'], ['1691236800000', '1831.51', '1836.15', '1829.2', '1832.82', '121237.51', '222115217.0989'], ['1691251200000', '1832.82', '1838.09', '1829.79', '1834.19', '102902.93', '188666069.1422'], ['1691265600000', '1834.19', '1837.7', '1832.78', '1835.6', '101713.51', '186623435.5648'], ['1691280000000', '1835.6', '1837.65', '1832.34', '1833.58', '103106.89', '189170852.6324'], ['1691294400000', '1833.58', '1835.52', '1831.06', '1833.65', '100586.84', '184436407.7516'], ['1691308800000', '1833.65', '1836.73', '1827.04', '1831.36', '102474.53', '187658849.9246'], ['1691323200000', '1831.36', '1831.67', '1824.63', '1828', '111377.65', '203643502.1302'], ['1691337600000', '1828', '1834.93', '1827.16', '1830.95', '83676.69', '153239945.4469'], ['1691352000000', '1830.95', '1837.09', '1826.54', '1828.95', '121329.05', '222148570.8278'], ['1691366400000', '1828.95', '1846.4', '1825.24', '1837.67', '134838.62', '247880405.1544'], ['1691380800000', '1837.67', '1841.28', '1831', '1835.83', '105926.08', '194528634.967'], ['1691395200000', '1835.83', '1836.63', '1831.72', '1833.08', '93170.04', '170897526.9065'], ['1691409600000', '1833.08', '1836.24', '1812.21', '1817.22', '163044.06', '297790228.0894'], ['1691424000000', '1817.22', '1830.46', '1800.52', '1824.34', '267371.57', '485419848.3701'], ['1691438400000', '1824.34', '1829.73', '1822.2', '1827.79', '141231.05', '257848789.6688'], ['1691452800000', '1827.79', '1834.39', '1824.79', '1828.9', '168508.98', '308143799.6129'], ['1691467200000', '1828.9', '1838.72', '1828.64', '1829.45', '147224.48', '269823264.4741'], ['1691481600000', '1829.45', '1837.99', '1829.09', '1837.77', '108787.47', '199204241.872'], ['1691496000000', '1837.77', '1847.87', '1834.02', '1842.03', '199942.4', '367894098.5888'], ['1691510400000', '1842.03', '1871.6', '1841.91', '1858.87', '243782.83', '452561864.1836'], ['1691524800000', '1858.87', '1877', '1854.68', '1855.91', '150256.36', '279686240.0406'], ['1691539200000', '1855.91', '1860.55', '1851.73', '1854.65', '112002.47', '207893166.0215'], ['1691553600000', '1854.65', '1862.97', '1853.65', '1861.57', '135246.23', '251144200.0958'], ['1691568000000', '1861.57', '1866.38', '1858.17', '1862.82', '137275.26', '255543923.311'], ['1691582400000', '1862.82', '1871.85', '1850.8', '1852.77', '187223.54', '348330193.7844'], ['1691596800000', '1852.77', '1854.82', '1845.83', '1847.84', '174538.63', '323031216.885'], ['1691611200000', '1847.84', '1858.11', '1846.54', '1854.82', '126597.16', '234619383.0606'], ['1691625600000', '1854.82', '1857.48', '1851.9', '1852.64', '132926.49', '246572527.5935'], ['1691640000000', '1852.64', '1855.38', '1849.39', '1850.6', '119212.76', '220752363.9732'], ['1691654400000', '1850.6', '1853.93', '1849.17', '1849.92', '102534.37', '189815056.3982'], ['1691668800000', '1849.92', '1865.94', '1847.91', '1853.11', '227995.13', '423113692.814'], ['1691683200000', '1853.11', '1853.34', '1844.92', '1848.46', '154912.49', '286429276.5775'], ['1691697600000', '1848.46', '1851.86', '1847.5', '1850.9', '117869.28', '218070086.0841'], ['1691712000000', '1850.9', '1853.49', '1841.57', '1845.48', '103840.36', '191936797.9509'], ['1691726400000', '1845.48', '1849.59', '1845.23', '1847.87', '116039.24', '214394316.442'], ['1691740800000', '1847.87', '1850.41', '1844.6', '1850.16', '108818.06', '201054118.3478'], ['1691755200000', '1850.16', '1856.78', '1842.31', '1844.55', '155502.72', '287614880.9174'], ['1691769600000', '1844.55', '1847.35', '1836.99', '1843.06', '137760.87', '253870086.6875'], ['1691784000000', '1843.06', '1850.25', '1842.77', '1847.48', '93757.99', '172991369.1411'], ['1691798400000', '1847.48', '1852.5', '1846.7', '1846.78', '102059.48', '188645613.0124'], ['1691812800000', '1846.78', '1850', '1845.99', '1849.45', '83947.61', '155072118.8932'], ['1691827200000', '1849.45', '1850.25', '1847.47', '1849.76', '96563.69', '178558916.2929'], ['1691841600000', '1849.76', '1852.42', '1849.27', '1849.63', '105096.31', '194516565.02'], ['1691856000000', '1849.63', '1851.7', '1846.01', '1846.41', '88729.9', '164021340.2164'], ['1691870400000', '1846.41', '1848.96', '1845.13', '1848.59', '78226.95', '144535317.6603'], ['1691884800000', '1848.59', '1850.42', '1847.69', '1848.44', '84356.22', '155981133.1011'], ['1691899200000', '1848.44', '1848.45', '1845.51', '1848.28', '73794.64', '136326558.1373'], ['1691913600000', '1848.28', '1850', '1847.8', '1848.37', '68804.47', '127234884.1739'], ['1691928000000', '1848.37', '1850.73', '1846.28', '1846.84', '94021.54', '173821604.041'], ['1691942400000', '1846.84', '1861.37', '1844.8', '1857.61', '110632.49', '204864105.9888'], ['1691956800000', '1857.61', '1859.19', '1833.31', '1839.63', '164956.58', '304092922.0074'], ['1691971200000', '1839.63', '1847.2', '1833.78', '1845.44', '126834.61', '233565726.894'], ['1691985600000', '1845.44', '1851', '1845.44', '1848.54', '108419.37', '200370942.1345'], ['1692000000000', '1848.54', '1851', '1844.97', '1847.02', '98960.63', '182890775.4676'], ['1692014400000', '1847.02', '1855.24', '1843.14', '1852.31', '146012.68', '269944446.2612'], ['1692028800000', '1852.31', '1854.6', '1838.5', '1841.44', '174513.28', '322286234.9607'], ['1692043200000', '1841.44', '1845.68', '1840.2', '1844.75', '125972.83', '232334485.2354'], ['1692057600000', '1844.75', '1846.37', '1842.62', '1843.66', '107507.68', '198303745.3724'], ['1692072000000', '1843.66', '1843.69', '1839.6', '1842.72', '101823.37', '187551649.2363'], ['1692086400000', '1842.72', '1844.15', '1837.25', '1839.3', '121021.65', '222906394.0373'], ['1692100800000', '1839.3', '1844.9', '1836.61', '1839.05', '97029.6', '178630758.7322'], ['1692115200000', '1839.05', '1841.42', '1811.47', '1826.68', '184772.19', '338240030.968'], ['1692129600000', '1826.68', '1831.32', '1824.24', '1827.9', '136332.47', '249322300.6043'], ['1692144000000', '1827.9', '1830.66', '1826.8', '1827.84', '72433.54', '132482181.3854'], ['1692158400000', '1827.84', '1828.2', '1819.55', '1826.37', '116452.89', '212520327.4603'], ['1692172800000', '1826.37', '1826.98', '1818.79', '1824.5', '117844.59', '214998703.2359'], ['1692187200000', '1824.5', '1827.44', '1818.21', '1819.62', '128369.11', '233989396.9859'], ['1692201600000', '1819.62', '1828.64', '1815.24', '1819.81', '151419.46', '275856693.4371'], ['1692216000000', '1819.81', '1821.85', '1795.68', '1807.17', '235766.27', '426427788.7282'], ['1692230400000', '1807.17', '1809.63', '1775', '1797.57', '217349.41', '390381938.6778'], ['1692244800000', '1797.57', '1802.38', '1796.48', '1799.1', '101388.4', '182438521.7149'], ['1692259200000', '1799.1', '1799.16', '1783.5', '1787.26', '173843.57', '311390907.9757'], ['1692273600000', '1787.26', '1792.77', '1720.61', '1738.58', '295268.29', '520747108.9386'], ['1692288000000', '1738.58', '1747.99', '1722.44', '1737.28', '185613.35', '322565084.5938'], ['1692302400000', '1737.28', '1738.53', '1467.36', '1680.08', '616078.7', '1014194017.5659'], ['1692316800000', '1680.08', '1698.1', '1671.74', '1675.95', '119854.4', '201975942.4826'], ['1692331200000', '1675.95', '1696.52', '1661', '1688.71', '154670.26', '259905014.3775'], ['1692345600000', '1688.71', '1695.89', '1677.07', '1684.58', '154556.79', '260434322.2816'], ['1692360000000', '1684.58', '1686.02', '1652.16', '1659.51', '212881.42', '355960611.9068'], ['1692374400000', '1659.51', '1677.7', '1637.57', '1656.39', '221264.78', '367195054.9599'], ['1692388800000', '1656.39', '1668.76', '1655.17', '1659.9', '176669.32', '293536407.4325'], ['1692403200000', '1659.9', '1670.56', '1655.08', '1658.35', '138988.37', '230958352.4701'], ['1692417600000', '1658.35', '1662.28', '1652.99', '1659.8', '106842.34', '177047506.7369'], ['1692432000000', '1659.8', '1664.44', '1657.75', '1658.59', '111547.77', '185197112.1289'], ['1692446400000', '1658.59', '1682.69', '1656.75', '1682.02', '129688.83', '215898313.0955'], ['1692460800000', '1682.02', '1695.58', '1673.53', '1676.16', '170909.04', '287255527.6172'], ['1692475200000', '1676.16', '1677', '1662.14', '1668.54', '109954.96', '183459818.2399'], ['1692489600000', '1668.54', '1674.03', '1663.51', '1666.69', '95751.22', '159659845.4256'], ['1692504000000', '1666.69', '1668.94', '1660.41', '1664.5', '95424.67', '158860587.5409'], ['1692518400000', '1664.5', '1674.37', '1662.2', '1673.61', '122461.26', '204353144.888'], ['1692532800000', '1673.61', '1678.63', '1663', '1669.75', '109196.71', '182609223.2132'], ['1692547200000', '1669.75', '1678.62', '1664.1', '1677.04', '81121.83', '135648877.9647'], ['1692561600000', '1677.04', '1693.69', '1676.97', '1683.71', '111654.68', '188004313.2892'], ['1692576000000', '1683.71', '1684.5', '1673.93', '1675.81', '123389.52', '207240238.8425'], ['1692590400000', '1675.81', '1687.22', '1668.16', '1670.47', '105477.13', '176601647.8889'], ['1692604800000', '1670.47', '1673.9', '1658.89', '1671.64', '135347.27', '225848987.1601'], ['1692619200000', '1671.64', '1683', '1647.08', '1656.11', '144752.16', '241215983.0933'], ['1692633600000', '1656.11', '1674.21', '1655.69', '1670.94', '129360.6', '215125520.0067'], ['1692648000000', '1670.94', '1675.9', '1664.99', '1666.49', '136470.22', '227852322.2622'], ['1692662400000', '1666.49', '1668', '1660', '1662.84', '120936.57', '201241794.8928'], ['1692676800000', '1662.84', '1665.68', '1659.55', '1665.06', '129680.06', '215563914.9619'], ['1692691200000', '1665.06', '1666.35', '1658.67', '1661.13', '121193.56', '201524963.2283'], ['1692705600000', '1661.13', '1665.97', '1644.5', '1648.71', '157189.06', '260405628.346'], ['1692720000000', '1648.71', '1649.86', '1617.31', '1623.84', '254664.43', '416167449.8819'], ['1692734400000', '1623.84', '1639.04', '1577.03', '1633.7', '252869.29', '408157824.6771'], ['1692748800000', '1633.7', '1641.52', '1628.04', '1630.64', '140652.97', '229703078.6082'], ['1692763200000', '1630.64', '1657.29', '1629.5', '1643.5', '133967.91', '219539942.5414']]
# 创建DataFrame
columns = ['timestamp', 'open', 'high', 'low', 'close', 'volume', 'amount']
df = pd.DataFrame(data, columns=columns)
df = df.astype({'open': float, 'high': float, 'low': float, 'close': float, 'volume': float, 'amount': float})
df['timestamp'] = pd.to_datetime(df['timestamp'], unit='ms')


# 计算HLC3
df['hlc3'] = (df['high'] + df['low'] + df['close']) / 3

# 计算SV
df['sv'] = np.where(df['hlc3'].diff() >= 0, df['volume'], -df['volume'])

# 计算KVO
ema_short = ta.EMA(df['sv'], 34)
ema_long = ta.EMA(df['sv'], 55)
df['kvo'] = ema_short - ema_long
close = np.array(df['close'])

def hma(period):
 wma_1 = df['close'].rolling(period//2).apply(lambda x: \
 np.sum(x * np.arange(1, period//2+1)) / np.sum(np.arange(1, period//2+1)), raw=True)
 wma_2 = df['close'].rolling(period).apply(lambda x: \
 np.sum(x * np.arange(1, period+1)) / np.sum(np.arange(1, period+1)), raw=True)
 diff = 2 * wma_1 - wma_2
 hma = diff.rolling(int(np.sqrt(period))).mean()
 return hma

period = 27
df['hma'] = hma(period)
print(df)
